# åŒæ­¥ä¸Šæ¸¸ä»“åº“æŒ‡ä»¤ (/syncfork)

ä» upstreamï¼ˆJustAuthï¼‰ä»“åº“è·å–æœ€æ–°æ›´æ–°ï¼Œå¹¶è¾…åŠ©æ‰‹åŠ¨åˆå¹¶åˆ° FastAuth é¡¹ç›®ã€‚

## èƒŒæ™¯è¯´æ˜

ç”±äº FastAuth å¯¹åŒ…åã€ç±»åç­‰è¿›è¡Œäº†å¤§å¹…ä¿®æ”¹ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ GitHub çš„ Sync Fork åŠŸèƒ½ã€‚
éœ€è¦é€šè¿‡æ­¤æŒ‡ä»¤æ‰‹åŠ¨æŸ¥çœ‹ upstream å˜æ›´ï¼Œå¹¶é€‰æ‹©æ€§åœ°å°†éœ€è¦çš„æ›´æ–°åº”ç”¨åˆ°æœ¬é¡¹ç›®ã€‚

**Upstream ä»“åº“**: https://github.com/justauth/JustAuth

## ä»»åŠ¡ç›®æ ‡

1. é…ç½® upstream è¿œç¨‹ä»“åº“ï¼ˆå¦‚æœªé…ç½®ï¼‰
2. è·å– upstream æœ€æ–°ä»£ç 
3. åˆ†æ upstream çš„å˜æ›´å†…å®¹
4. è¾…åŠ©ç”¨æˆ·é€‰æ‹©æ€§åˆå¹¶éœ€è¦çš„æ›´æ–°

## æ‰§è¡Œæ­¥éª¤

### æ­¥éª¤ 1: æ£€æŸ¥å¹¶é…ç½® upstream

```bash
# æ£€æŸ¥æ˜¯å¦å·²é…ç½® upstream
git remote -v

# å¦‚æœæ²¡æœ‰ upstreamï¼Œæ·»åŠ å®ƒ
git remote add upstream https://github.com/justauth/JustAuth.git
```

### æ­¥éª¤ 2: è·å– upstream æœ€æ–°ä»£ç 

```bash
# è·å– upstream æ‰€æœ‰åˆ†æ”¯å’Œæ ‡ç­¾
git fetch upstream --tags

# æŸ¥çœ‹ upstream çš„æœ€æ–°æäº¤
git log upstream/master --oneline -10
```

### æ­¥éª¤ 3: åˆ†æå˜æ›´å·®å¼‚

```bash
# æŸ¥çœ‹æœ¬åœ° master å’Œ upstream/master çš„å·®å¼‚ï¼ˆæŒ‰æ–‡ä»¶ï¼‰
git diff master..upstream/master --stat

# æŸ¥çœ‹ upstream æœ€è¿‘çš„å˜æ›´æ—¥å¿—
git log master..upstream/master --oneline

# æŸ¥çœ‹å…·ä½“æŸä¸ªæäº¤çš„å†…å®¹
git show <commit-hash> --stat
```

### æ­¥éª¤ 4: ç”Ÿæˆå˜æ›´åˆ†ææŠ¥å‘Š

å‘ç”¨æˆ·å±•ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š

```
ğŸ“Š Upstream æ›´æ–°åˆ†ææŠ¥å‘Š

**ä¸Šæ¸¸ä»“åº“**: justauth/JustAuth
**æœ¬åœ°åˆ†æ”¯**: master
**ä¸Šæ¸¸åˆ†æ”¯**: upstream/master

---

## ğŸ“ æ–°å¢æäº¤ (å…± X ä¸ª)

| æäº¤ Hash | æ—¥æœŸ | ä½œè€… | æè¿° |
|-----------|------|------|------|
| abc1234 | 2024-01-15 | author | fix: ä¿®å¤å¾®ä¿¡ç™»å½•é—®é¢˜ |
| def5678 | 2024-01-10 | author | feat: æ–°å¢æŠ–éŸ³ç™»å½•æ”¯æŒ |

---

## ğŸ“ å˜æ›´æ–‡ä»¶åˆ†ç±»

### ğŸ†• æ–°å¢å¹³å°æ”¯æŒ
- `src/main/java/me/zhyd/oauth/request/AuthXxxRequest.java`
- éœ€è¦å¤åˆ¶å¹¶ä¿®æ”¹åŒ…åä¸º `com.yiancode.fastauth.request.AuthXxxRequest`

### ğŸ› Bug ä¿®å¤
- `src/main/java/me/zhyd/oauth/request/AuthWechatRequest.java`
- éœ€è¦å°†ä¿®å¤å†…å®¹æ‰‹åŠ¨åº”ç”¨åˆ°å¯¹åº”æ–‡ä»¶

### ğŸ“š æ–‡æ¡£æ›´æ–°
- `README.md` (å¯å¿½ç•¥ï¼Œæˆ‘ä»¬æœ‰è‡ªå·±çš„æ–‡æ¡£)

### âš™ï¸ é…ç½®å˜æ›´
- `pom.xml` - æ£€æŸ¥ä¾èµ–ç‰ˆæœ¬æ›´æ–°

---

## ğŸ¯ å»ºè®®æ“ä½œ

1. **é«˜ä¼˜å…ˆçº§** - éœ€è¦åˆå¹¶çš„ Bug ä¿®å¤
   - [ ] æäº¤ abc1234: ä¿®å¤å¾®ä¿¡ç™»å½•é—®é¢˜

2. **ä¸­ä¼˜å…ˆçº§** - æ–°åŠŸèƒ½ï¼ˆæŒ‰éœ€åˆå¹¶ï¼‰
   - [ ] æäº¤ def5678: æ–°å¢æŠ–éŸ³ç™»å½•æ”¯æŒ

3. **ä½ä¼˜å…ˆçº§/å¯å¿½ç•¥**
   - æ–‡æ¡£æ›´æ–°
   - ä»£ç æ ¼å¼è°ƒæ•´
```

### æ­¥éª¤ 5: è¾…åŠ©æ‰‹åŠ¨åˆå¹¶

æ ¹æ®ç”¨æˆ·é€‰æ‹©ï¼Œæä¾›å…·ä½“çš„åˆå¹¶æŒ‡å¯¼ï¼š

#### åœºæ™¯ A: åˆå¹¶æ–°å¢çš„å¹³å°æ”¯æŒ

```bash
# 1. æŸ¥çœ‹ upstream ä¸­æ–°æ–‡ä»¶çš„å†…å®¹
git show upstream/master:src/main/java/me/zhyd/oauth/request/AuthXxxRequest.java

# 2. åˆ›å»ºå¯¹åº”çš„æœ¬åœ°æ–‡ä»¶
# å¤åˆ¶å†…å®¹åˆ° src/main/java/com/yiancode/fastauth/request/AuthXxxRequest.java

# 3. éœ€è¦ä¿®æ”¹çš„å†…å®¹:
#    - package me.zhyd.oauth â†’ package com.yiancode.fastauth
#    - import me.zhyd.oauth.* â†’ import com.yiancode.fastauth.*
#    - æ³¨é‡Šä¸­çš„ JustAuth â†’ FastAuth
```

#### åœºæ™¯ B: åˆå¹¶ Bug ä¿®å¤

```bash
# 1. æŸ¥çœ‹å…·ä½“çš„ä¿®å¤å†…å®¹
git show <commit-hash>

# 2. æ‰¾åˆ°å¯¹åº”çš„æœ¬åœ°æ–‡ä»¶
# upstream: src/main/java/me/zhyd/oauth/request/AuthWechatRequest.java
# æœ¬åœ°:     src/main/java/com/yiancode/fastauth/request/AuthWechatRequest.java

# 3. æ‰‹åŠ¨å°†ä¿®å¤å†…å®¹åº”ç”¨åˆ°æœ¬åœ°æ–‡ä»¶
```

#### åœºæ™¯ C: åˆå¹¶ä¾èµ–æ›´æ–°

```bash
# 1. æŸ¥çœ‹ upstream çš„ pom.xml å˜æ›´
git diff master..upstream/master -- pom.xml

# 2. æ‰‹åŠ¨æ›´æ–°æœ¬åœ° pom.xml ä¸­å¯¹åº”çš„ä¾èµ–ç‰ˆæœ¬
```

### æ­¥éª¤ 6: éªŒè¯åˆå¹¶ç»“æœ

```bash
# ç¼–è¯‘æ£€æŸ¥
mvn compile

# è¿è¡Œæµ‹è¯•
mvn test

# å¦‚æœæˆåŠŸï¼Œæäº¤å˜æ›´
git add .
git commit -m "sync: ä» upstream åˆå¹¶æ›´æ–°

- åˆå¹¶ Bug ä¿®å¤: xxx
- æ–°å¢å¹³å°æ”¯æŒ: xxx
- æ›´æ–°ä¾èµ–ç‰ˆæœ¬: xxx

Upstream commits: abc1234, def5678
"
```

## è¾“å‡ºæ ¼å¼

### æˆåŠŸæ‰§è¡Œ

```
âœ… Upstream åŒæ­¥åˆ†æå®Œæˆ

ğŸ“Š åˆ†æç»“æœ:
- ä¸Šæ¸¸æ–°å¢æäº¤: X ä¸ª
- æ¶‰åŠæ–‡ä»¶: Y ä¸ª
- æ–°å¢å¹³å°: Z ä¸ª

ğŸ“‹ è¯¦ç»†æŠ¥å‘Šå·²ç”Ÿæˆï¼Œè¯·æŸ¥çœ‹ä¸Šæ–¹åˆ†æç»“æœã€‚

ğŸ’¡ ä¸‹ä¸€æ­¥æ“ä½œ:
1. æŸ¥çœ‹ä¸Šæ–¹çš„å˜æ›´åˆ†ææŠ¥å‘Š
2. å†³å®šéœ€è¦åˆå¹¶çš„å†…å®¹
3. æŒ‰ç…§æŒ‡å¯¼æ‰‹åŠ¨åˆå¹¶ä»£ç 
4. è¿è¡Œ `mvn compile` éªŒè¯
5. ä½¿ç”¨ `/commit` æäº¤å˜æ›´
```

### æ— æ›´æ–°

```
âœ… æ£€æŸ¥å®Œæˆ

å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œupstream æ²¡æœ‰æ–°çš„æ›´æ–°ã€‚

ä¸Šæ¬¡æ£€æŸ¥æ—¶é—´: {æ—¶é—´}
Upstream æœ€æ–°æäº¤: {hash} - {message}
```

### é”™è¯¯å¤„ç†

```
âŒ åŒæ­¥å¤±è´¥

é”™è¯¯åŸå› : {å…·ä½“é”™è¯¯}

å»ºè®®æ“ä½œ:
- ç½‘ç»œé—®é¢˜: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œé‡æ–°è¿è¡Œ /syncfork
- æƒé™é—®é¢˜: ç¡®è®¤æœ‰ upstream ä»“åº“çš„è®¿é—®æƒé™
- å†²çªé—®é¢˜: å…ˆè§£å†³æœ¬åœ°æœªæäº¤çš„å˜æ›´
```

## å¿«æ·é€‰é¡¹

æ”¯æŒå‚æ•°åŒ–è°ƒç”¨:

- `/syncfork` - å®Œæ•´åˆ†ææµç¨‹
- `/syncfork --check` - ä»…æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ–°ï¼Œä¸ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
- `/syncfork --commits` - ä»…æ˜¾ç¤ºæ–°å¢æäº¤åˆ—è¡¨
- `/syncfork --files` - ä»…æ˜¾ç¤ºå˜æ›´æ–‡ä»¶åˆ—è¡¨

## åŒ…åæ˜ å°„è¡¨

åœ¨åˆå¹¶æ—¶éœ€è¦è¿›è¡Œçš„æ›¿æ¢:

| Upstream | FastAuth |
|----------|----------|
| `me.zhyd.oauth` | `com.yiancode.fastauth` |
| `JustAuth` | `FastAuth` |
| `JustAuthLogConfig` | `FastAuthLogConfig` |

## æ³¨æ„äº‹é¡¹

1. **ä¸è¦ç›´æ¥ merge**: ç”±äºåŒ…åå®Œå…¨ä¸åŒï¼Œgit merge ä¼šäº§ç”Ÿå¤§é‡å†²çª
2. **é€‰æ‹©æ€§åˆå¹¶**: åªåˆå¹¶éœ€è¦çš„åŠŸèƒ½å’Œä¿®å¤
3. **ä¿æŒç‹¬ç«‹æ€§**: FastAuth ä½œä¸ºç‹¬ç«‹é¡¹ç›®å‘å±•ï¼Œä¸å¿…åŒæ­¥æ‰€æœ‰æ›´æ–°
4. **æµ‹è¯•éªŒè¯**: æ¯æ¬¡åˆå¹¶ååŠ¡å¿…è¿è¡Œæµ‹è¯•ç¡®ä¿ä»£ç æ­£å¸¸
5. **è®°å½•æ¥æº**: æäº¤ä¿¡æ¯ä¸­æ³¨æ˜ upstream çš„ç›¸å…³ commit hash

## ç›¸å…³æŒ‡ä»¤

- `/commit` - æäº¤ä»£ç å˜æ›´
- `/syncfork --check` - å¿«é€Ÿæ£€æŸ¥ upstream æ›´æ–°